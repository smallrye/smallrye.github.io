<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Config Sources :: SmallRye documentation</title>
    <meta name="generator" content="Antora 2.3.0-beta.1">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">SmallRye documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Projects</a>

          <!-- TODO: This is the navigation. Do we want it here? -->
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../index/index/index.html">Index</a>
            <a class="navbar-item" href="../index.html">SmallRye Config</a>
            <a class="navbar-item" href="../../smallrye-jwt/index.html">SmallRye JWT</a>
            <a class="navbar-item" href="../../smallrye-metrics/2.4.0/index.html">SmallRye Metrics</a>
          </div>

        </div>
        <a class="navbar-item" href="https://smallrye.io/" alt=>SmallRye.io main website</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="smallrye-config" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">SmallRye Config</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Index</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/config.html">Config</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="config-sources.html">Config Sources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../converters/converters.html">Converters</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interceptors/interceptors.html">Interceptors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping/mapping.html">Mapping</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../cdi/cdi.html">CDI</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<!-- This is the default navigation panel in the bottom left corner. We aren't using it, but let's keep it commented out
    should we change our minds about it -->
<!--
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SmallRye Config</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Index</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../index/index/index.html">index</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">SmallRye Config</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">SmallRye JWT</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../smallrye-jwt/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">SmallRye Metrics</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../smallrye-metrics/2.4.0/index.html">2.4.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
-->
    </div>
  </aside>
</div>
<main>
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index/index/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">SmallRye Config</a></li>
    <li><a href="config-sources.html">Config Sources</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/smallrye/smallrye-config/edit/master/doc/modules/ROOT/pages/config-sources/config-sources.adoc">Edit this Page</a></div>
  </div>
<article class="doc">
<h1 class="page">Config Sources</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>SmallRye Config provides a few enhancements and extensions to MicroProfile Config <code>ConfigSource</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_config_source_factory"><a class="anchor" href="#_config_source_factory"></a>Config Source Factory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Another way to create a <code>ConfigSource</code> is via the <code>ConfigSourceFactory</code>. The difference between the SmallRye Factory
and the standard way to create a <code>ConfigSource</code> as specified in MicroProfile Config, is the Factory ability to provide
a context with access to the available configuration. With the <code>ConfigSourceFactory</code> it is possible to bootstrap a
<code>ConfigSource</code> that configures itself with other <code>ConfigSources</code></p>
</div>
<div class="paragraph">
<p>By implementing <a href="https://github.com/smallrye/smallrye-config/blob/master/implementation/src/main/java/io/smallrye/config/ConfigSourceFactoryjava">ConfigSourceFactory</a>, the ConfigSource is made available via the
<code>ConfigSource getConfigSource(ConfigSourceContext context)</code> method. The <code>ConfigSourceFactory</code> can be also assigned a
priority, like any other <code>ConfigSource</code> by overriding the method <code>OptionalInt getPriority()</code>.</p>
</div>
<div class="paragraph">
<p>When the Factory is initializing, the provided <code>ConfigSourceContext</code> may call a single method
<code>ConfigValue getValue(String name)</code>. This method lookups configuration names in all <code>ConfigSources</code> that are already
initialized by the <code>Config</code> even if they have a lower priority than the one defined in the <code>ConfigSourceFactory</code>. A
<code>ConfigSource</code> produced by a <code>ConfigSourceFactory</code> is not taken into account to configure other sources produced by
lower priority <code>ConfigSourceFactory</code>.</p>
</div>
<div class="paragraph">
<p>Registration of a <code>ConfigSourceFactory</code> is done via the <code>ServiceLoader</code> mechanism by providing the
implementation classes in a <code>META-INF/services/io.smallrye.config.ConfigSourceFactory</code> file. Alternatively, factories
may be registered via the Programmatic API in <code>SmallRyeConfigBuilder#withSources</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_available_config_sources"><a class="anchor" href="#_available_config_sources"></a>Available Config Sources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to the default Config Sources specified by MicroProfile Config (Environment Variables, System Properties
and <code>microprofile-config.properties</code> file), SmallRye Config provides the following additional Sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#properties-config-source">Properties Config Source</a></p>
</li>
<li>
<p><a href="#configvalueproperties-config-source">Config Value Properties Config Source</a></p>
</li>
<li>
<p><a href="#filesystem-config-source">FileSystem Config Source</a></p>
</li>
<li>
<p><a href="#hocon-config-source">HOCON Config Source</a></p>
</li>
<li>
<p><a href="#yaml-config-source">YAML Config Source</a></p>
</li>
<li>
<p><a href="#zookeeper-config-source">ZooKeeper Config Source</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="properties-config-source"><a class="anchor" href="#properties-config-source"></a>Properties Config Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creates a ConfigSource from Java <code>Properties</code> or <code>Map&lt;String, String&gt;</code> objects or a properties file (referenced by
its URL). Check
<a href="https://github.com/smallrye/smallrye-config/blob/master/implementation/src/main/java/io/smallrye/config/PropertiesConfigSource.java">PropertiesConfigSource.java</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configvalueproperties-config-source"><a class="anchor" href="#configvalueproperties-config-source"></a>Config Value Properties Config Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creates a Config Source with <code>ConfigValue</code> support from a properties file (referenced by its URL).</p>
</div>
<div class="paragraph">
<p>The <code>ConfigValue</code> is a metadata object, containing additional information to each configuration. This includes the
Config Source origin, ordinal, or the line number from where the Config was loaded. This is useful for debugging
information.</p>
</div>
<div class="sect2">
<h3 id="_usage"><a class="anchor" href="#_usage"></a>Usage</h3>
<div class="paragraph">
<p>This Config Source is not automatically registered. This means that need to provide your own
<code>ConfigSourceProvider</code> implementation and registration via <code>ServiceLoader</code> to use this Config Source like documented in
MicroProfile Config <code>ConfigSource</code> specification.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="filesystem-config-source"><a class="anchor" href="#filesystem-config-source"></a>FileSystem Config Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creates a ConfigSource that will look into a directory where each file corresponds to a property (the file name is
the property key and its textual content is the property value).</p>
</div>
<div class="paragraph">
<p>For example, if a directory structure looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>foo/
|__num.max
|__num.size</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>new FileSystemConfigSource("foo")</code> will provide 2 properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>num.max</p>
</li>
<li>
<p>num.size</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And their values is the file content.</p>
</div>
<div class="paragraph">
<p>Nested directories are not supported.</p>
</div>
<div class="paragraph">
<p>This Config Source can be used to read configuration from
<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap">Kubernetes ConfigMap</a>.</p>
</div>
<div class="paragraph">
<p>The same mapping rules as defined for environment variables are applied, so the FileSystemConfigSource will search for a given property name (e.g. com.ACME.size):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Exact match (i.e. com.ACME.size)</p>
</li>
<li>
<p>Replace each character that is neither alphanumeric nor _ with _ (i.e. com_ACME_size)</p>
</li>
<li>
<p>Replace each character that is neither alphanumeric nor _ with _; then convert the name to upper case (i.e. COM_ACME_SIZE)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_usage_2"><a class="anchor" href="#_usage_2"></a>Usage</h3>
<div class="paragraph">
<p>To use the FileSystem Config Source, add the following to your Maven <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.smallrye.config&lt;/groupId&gt;
    &lt;artifactId&gt;smallrye-config-source-file-system&lt;/artifactId&gt;
    &lt;version&gt;1.9.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This Config Source is not automatically registered. This means that you also need to provide your own
<code>ConfigSourceProvider</code> implementation and registration via <code>ServiceLoader</code> to use this Config Source like documented in
MicroProfile Config <code>ConfigSource</code> specification.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hocon-config-source"><a class="anchor" href="#hocon-config-source"></a>HOCON Config Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ConfigSource implementation to support <a href="https://github.com/lightbend/config/blob/master/HOCON.md">HOCON</a> file format.</p>
</div>
<div class="paragraph">
<p>This Configuration Source will be looking for the following files in this order of priority:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>META-INF/microprofile-config.conf</code></p>
</li>
<li>
<p><code>WEB-INF/classes/META-INF/microprofile-config.conf</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These configuration files have a lower priority than the default sources.</p>
</div>
<div class="sect2">
<h3 id="_usage_3"><a class="anchor" href="#_usage_3"></a>Usage</h3>
<div class="paragraph">
<p>To use the HOCON Config Source, add the following to your Maven <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.smallrye.config&lt;/groupId&gt;
    &lt;artifactId&gt;smallrye-config-source-hocon&lt;/artifactId&gt;
    &lt;version&gt;1.9.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This Config Source will automatically register with your application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="yaml-config-source"><a class="anchor" href="#yaml-config-source"></a>YAML Config Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Config Source allows you to use a <code>yaml</code> file to describe your configuration. By default, the YAML Config Source
loads the configuration from the file <code>microprofile-config.yaml</code>.</p>
</div>
<div class="paragraph">
<p>This Config Source has a higher priority than the default <code>microprofile-config.properties</code>.</p>
</div>
<div class="sect2">
<h3 id="_usage_4"><a class="anchor" href="#_usage_4"></a>Usage</h3>
<div class="paragraph">
<p>To use the YAML Config Source, add the following to your Maven <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.smallrye.config&lt;/groupId&gt;
    &lt;artifactId&gt;smallrye-config-source-yaml&lt;/artifactId&gt;
    &lt;version&gt;1.9.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This Config Source will automatically register with your application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="zookeeper-config-source"><a class="anchor" href="#zookeeper-config-source"></a>ZooKeeper Config Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Config Source implementation to support Apache Zookeeper.</p>
</div>
<div class="paragraph">
<p>The benefits are that configurations can be shared across applications and a future version will allow applications to
subscribe to updates to the configuration parameters.</p>
</div>
<div class="sect2">
<h3 id="_usage_5"><a class="anchor" href="#_usage_5"></a>Usage</h3>
<div class="paragraph">
<p>To use the HOCON Config Source, add the following to your Maven <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.smallrye.config&lt;/groupId&gt;
    &lt;artifactId&gt;smallrye-config-source-zookeeper&lt;/artifactId&gt;
    &lt;version&gt;1.9.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This Config Source will automatically register with your application.</p>
</div>
<div class="paragraph">
<p>You also need to bootstrap your application with the location of your Zookeeper server and a unique identifier for your
application. Add the following to <code>src/main/resources/META-INF/microprofile-config.properties</code> or create equivalent
Environment Variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">io.smallrye.configsource.zookeeper.url=localhost:2181
io.smallrye.configsource.zookeeper.applicationId=com.example.my-application</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any properties that are looked up via the Config API or Injected will be looked up in Zookeeper in addition to the
default MicroProfile Config locations.</p>
</div>
<div class="paragraph">
<p>The ConfigSource will store the following znodes in the specified Zookeeper server
<code>/applicationId/propertyName = value</code>.</p>
</div>
<div class="paragraph">
<p>This Config Source has a lower priority than the default Sources and thus <strong>will not</strong> override property files or
Environment Variables.</p>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
