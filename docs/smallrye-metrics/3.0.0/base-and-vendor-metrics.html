<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Activating base and vendor metrics :: SmallRye documentation</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <button class="nav-toggle"></button>

      <a class="navbar-item title" href="index.html">SmallRye Metrics</a>

      <div class="navbar-item has-dropdown is-hoverable">
        <span class="navbar-link">3.0.0</span>
        <div class="navbar-dropdown navbar-menu">
            <a class="navbar-item  is-current" href="index.html">3.0.0</a>
            <a class="navbar-item " href="../2.4.0/index.html">2.4.0</a>
        </div>
      </div>


      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <span class="navbar-link">Projects</span>
          <div class="navbar-dropdown">
              <a class="navbar-item" href="../../index/index/index.html">Index</a>
              <a class="navbar-item" href="../../smallrye-fault-tolerance/5.5.0/index.html">SmallRye Fault Tolerance</a>
              <a class="navbar-item" href="../../smallrye-health/3.0.1/index.html">SmallRye Health</a>
              <a class="navbar-item" href="../../smallrye-jwt/index.html">SmallRye JWT</a>
              <a class="navbar-item" href="index.html">SmallRye Metrics</a>
          </div>
        </div>

        <a class="navbar-item" href="https://smallrye.io/">SmallRye.io main website</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="smallrye-metrics" data-version="3.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list nav-list-level-0">
  <li class="nav-item nav-item-level-0">
<ul class="nav-list nav-list-level-1">
  <li class="nav-item nav-item-level-1">
    <a class="nav-link" href="index.html">Index</a>
  </li>
  <li class="nav-item nav-item-level-1">
    <span class="nav-text">Features on top of the specification</span>
<ul class="nav-list nav-list-level-2">
  <li class="nav-item nav-item-level-2">
    <a class="nav-link" href="extended-metadata.html">Extended metadata</a>
  </li>
</ul>
  </li>
  <li class="nav-item nav-item-level-1">
    <span class="nav-text">Integrating SmallRye Metrics into runtimes</span>
<ul class="nav-list nav-list-level-2">
  <li class="nav-item nav-item-level-2">
    <a class="nav-link" href="cdi-extension.html">CDI Extension</a>
  </li>
  <li class="nav-item nav-item-level-2 is-current-page">
    <a class="nav-link" href="base-and-vendor-metrics.html">Base and vendor metrics</a>
  </li>
  <li class="nav-item nav-item-level-2">
    <a class="nav-link" href="metric-registry-lifecycle.html">Metric registry lifecycle</a>
  </li>
  <li class="nav-item nav-item-level-2">
    <a class="nav-link" href="jaxrs-metrics.html">JAX-RS metrics</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Table of contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
  <a href="https://github.com/smallrye/smallrye-metrics/edit/main/doc/modules/ROOT/pages/base-and-vendor-metrics.adoc" class="edit-this-page" title="Edit this page">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>
<h1 class="page">Activating base and vendor metrics</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Base and vendor metrics are registered at deployment time by the <code>io.smallrye.metrics.setup.JmxRegistrar</code>
class. It is necessary to instantiate it and invoke <code>jmxRegistrar.init()</code>. The definitions of base and vendor
metrics are read from the file <code>base-metrics.properties</code> and <code>vendor-metrics.properties</code>, which should be available
as a resource under the path <code>/io/smallrye/metrics/*-metrics.properties</code> for either the classloader that
loaded the <code>JmxRegistrar</code> class (higher precedence) or the thread context class loader (lower precedence).</p>
</div>
<div class="paragraph">
<p>These files reference management MBeans as the sources of metric values, so they can only be used for metrics
that are obtained from MBeans, and only in cases when JMX is available at runtime. Furthermore, only
Counters and Gauges are currently supported through this file. In other cases, a different
approach must be devised to register base and vendor metrics (but the specification does not require
any base metrics of different types).</p>
</div>
<div class="paragraph">
<p>Note that JAX-RS metrics are a bit special and use a different mechanism. For info, see
<a href="jaxrs-metrics.html" class="page">JAX-RS Metrics</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_base_metrics_properties_and_vendor_metrics_properties_file_schema"><a class="anchor" href="#_base_metrics_properties_and_vendor_metrics_properties_file_schema"></a>base-metrics.properties and vendor-metrics.properties file schema</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These files list all base and vendor metrics through usage of a regular Java properties file.
The schema is as following:</p>
</div>
<div class="paragraph">
<p>For simple metrics (where one MBean property corresponds to one metric), you will need these properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property meaning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIC_NAME.displayName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The display name of the metric</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIC_NAME.type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the metric (can be <code>counter</code> or <code>gauge</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIC_NAME.unit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The unit of the metric as a string (you can use <code>none</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIC_NAME.description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The description of the metric</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIC_NAME.mbean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference to a JMX property including the <code>ObjectName</code> of the owning MBean.
For example, <code>java.lang:type=ClassLoading/TotalLoadedClassCount</code>
to obtain the total of all loaded classes in the JVM.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>
    Sponsored by <a href="https://www.redhat.com"><img style="vertical-align: middle; height: 2.5em;" src="../../_/img/redhat.svg" alt="Red Hat"></a>
  </p>
  <p>
    Made with <a href="https://github.com/smallrye/smallrye-antora-ui">SmallRye Antora UI</a>, which is licensed under the MPL-2.0 license.
    Includes portions of <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a>, which is licensed under the MIT license.
  </p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
