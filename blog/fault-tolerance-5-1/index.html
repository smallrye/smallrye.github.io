<!DOCTYPE html>
<html>

<head>
  <title>Fault Tolerance 5.1</title>
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlightjs-pack.js" type="text/javascript"></script>
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://smetrics.redhat.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      https://www.redhat.com
      https://static.redhat.com
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://www.google-analytics.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <META HTTP-EQUIV="X-Frame-Options" CONTENT="DENY">
  <META HTTP-EQUIV="X-XSS-Protection" CONTENT="1; mode=block">
  <META HTTP-EQUIV="X-Content-Type-Options" CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="SmallRye is a project to share and collaborate on implementing specifications that are part of Eclipse MicroProfile.">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
</head>

<body class="post">

  <div class="content">
    <div class="navigation-wrapper">
  <div class="width-12-12">
    <div class="header navigation">
      <div class="logo-wrapper">
        <a href="/"><img class="project-logo" title="SmallRye" src="/assets/images/smallrye_project_logo.svg"></a>
      </div>
      <div class="nav-container">
        <nav>
          <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
          <ul class="nav-list">
            <li>
              <a href="/projects/" class="">Projects</a>
            </li>
            <li>
              <a href="/community/" class="">Community</a>
            </li>
            <li>
              <a href="/blog/" class="active">Blog</a>
            </li>
            <li>
              <a href="/docs/index.html" class="">Documentation</a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>

    <div class="post-page grid-wrapper">
  <div class="grid__item width-10-12 doc-content">
    <h1>Fault Tolerance 5.1</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Today, we announce the <a href="https://github.com/smallrye/smallrye-fault-tolerance/releases/tag/5.1.0">release</a> of SmallRye Fault Tolerance 5.1.0.
This release includes some important bug fixes and one new feature.
It is a safe upgrade for everyone using SmallRye Fault Tolerance 5.0.0.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="java_16_support">Java 16 support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SmallRye Fault Tolerance includes a small utility class that helps calling <code>default</code> methods when they are declared as fallback methods with <code>@Fallback</code>.
This class uses reflection to crack open some internal JDK classes on Java 8.
Naturally, since Java 9, the JDK started complaining, and since Java 16, this became an error.</p>
</div>
<div class="paragraph">
<p>For that reason, we have a variant of that utility class that uses Java 9 public API, and the main SmallRye Fault Tolerance JAR has, for a long time, been a multi-release JAR.
Unfortunately, we introduced a bug in SmallRye Fault Tolerance 4.3.1.
This bug causes the main SmallRye Fault Tolerance JAR to omit the <code>META-INF/versions/9</code> directory, and so the Java 8 variant of the class is the only one present.</p>
</div>
<div class="paragraph">
<p>In the 5.1.0 release, we fixed that bug and made sure the SmallRye Fault Tolerance release process is executed with Java 11.
Hence, SmallRye Fault Tolerance should once again work as intended on all Java versions, particularly on Java 16.</p>
</div>
<div class="paragraph">
<p>Note that even though we run the release process with Java 11, we still produce Java 8 bytecode.
Java 8 is still supported with SmallRye Fault Tolerance 5.1.0, even though we may drop this support in future versions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="vert_x_integration">Vert.x integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In certain situations, SmallRye Fault Tolerance runs <code>@NonBlocking</code> methods on a different thread than the original call was made on.
This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Retry</code> methods, where a non-zero retry delay is configured (the delay must not block);</p>
</li>
<li>
<p><code>@Bulkhead</code> methods, where a non-zero bulkhead queue is configured (if the invocation is queued).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, we run such guarded methods on a thread pool provided by the integrator.
In this release, we provide an integration API for event loops, as well as an implementation of this API for Vert.x.</p>
</div>
<div class="paragraph">
<p>With this integration enabled, invocations of <code>@NonBlocking</code> methods made on an event loop thread are always executed on the same event loop thread.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://smallrye.io/docs/smallrye-fault-tolerance/5.1.0/usage/extra.html#blocking-nonblocking">user documentation</a> and <a href="https://smallrye.io/docs/smallrye-fault-tolerance/5.1.0/integration/event-loop.html">integration documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="others">Others</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have also significantly expanded our CI coverage.
We now run tests with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all Java LTS releases we care about (at this moment, Java 8 and 11);</p>
</li>
<li>
<p>the latest Java release (at this moment, Java 16);</p>
</li>
<li>
<p>the upcoming Java release (at this moment, Java 17-ea).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of this on Linux, Windows and macOS, thanks to GitHub Actions.</p>
</div>
<div class="paragraph">
<p>(In fact, we currently don&#8217;t run tests with Java 17-ea, because of <a href="https://github.com/smallrye/smallrye-fault-tolerance/issues/412">a bug</a> in JBoss Class File Writer. That should be resolved shortly, and we are not aware of any other issue with Java 17-ea.)</p>
</div>
<div class="paragraph">
<p>With this CI coverage expansion, we found and fixed a particularly nasty concurrency issue in handling <code>@Timeout</code>s on <code>Future</code>-returning methods when <code>@Retry</code> is present.
<code>@Bulkhead</code>s on <code>Future</code>-returning methods, in presence of <code>@Retry</code>, were fixed as well.</p>
</div>
<div class="paragraph">
<p>Upgrade to 5.1.0 is therefore very much recommended!</p>
</div>
</div>
</div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/smallrye_project_logo.svg" class="project-logo" title="SmallRye"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">SmallRye is open source under <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>. <br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> is hosted on <a href='https://pages.github.com/' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/smallrye/smallrye.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="/">Home</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Contribute</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://twitter.com/smallrye_io">Follow us</a></li>
          
            <li><a href="https://github.com/smallrye">GitHub</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://quarkusio.zulipchat.com">Chatroom</a></li>
          
            <li><a href="https://groups.google.com/d/forum/smallrye">Google&nbsp;Groups</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-6-12 more-links">
        <span>External Links</span>
        <ul class="footer-links">
          
            <li><a href="https://microprofile.io/" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://github.com/eclipse?utf8=✓&q=microprofile" target="_blank">Eclipse MicroProfile on GitHub</a></li>
          
        </ul>
      </div>
    
  </div>
</div>
  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a>
      | <a href="https://www.redhat.com/en/about/privacy-policy">Red Hat Privacy Policy</a>
    </span>
    <span class="redhat">
      a Red Hat sponsored project   
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script type="text/javascript" src="/assets/javascript/satellite.js"></script>
</body>

</html>
